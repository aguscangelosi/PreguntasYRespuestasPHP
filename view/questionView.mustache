<h1>Pregunta</h1>

<p>{{enunciado}}</p>
<p><strong>Dificultad:</strong> {{dificultad}}</p>

<h2>Selecciona la respuesta</h2>
<ul id="respuestas">
    {{#respuestas}}
        <li>
            <button class="respuesta-btn" data-correcta="{{es_correcta}}">
                {{texto_respuesta}}
            </button>
        </li>
    {{/respuestas}}
</ul>
<div id="botón" style="margin-top: 10px;">
        <button name="es-correcta" id="boton_continuar">Continuar</button>
</div>

<div id="resultado" style="margin-top: 10px;"></div>
<input type="hidden" value="{{idMatch}}" id="idMatch">

<script>
    let esCorrecta;
    document.addEventListener('DOMContentLoaded', function () {
        const respuestaButtons = document.querySelectorAll('.respuesta-btn');
        const resultadoDiv = document.getElementById('resultado');

        respuestaButtons.forEach(button => {
            button.addEventListener('click', function () {
                esCorrecta = this.getAttribute('data-correcta') === "1"; // Ajusta "1" si es booleano en tu base de datos

                respuestaButtons.forEach(btn => {
                    const btnEsCorrecta = btn.getAttribute('data-correcta') === "1";
                    if (btnEsCorrecta) {
                        btn.style.backgroundColor = 'green';
                        btn.style.color = 'white';
                    } else {
                        btn.style.backgroundColor = 'red';
                        btn.style.color = 'white';
                    }
                });

                if (esCorrecta) {
                    resultadoDiv.innerHTML = '<p style="color: green;">¡Correcto!</p>';
                    // deberia volver a tirar rule por ende rederigir y que tire de nuevo
                    // Antes de la pregunta debemos crear el objeto intermedio entre user y partida, para poder ir almacenando
                    // los puntajes y si pierda ya tener los puntos y mostrarlos
                } else {
                    // si pierde tiene que tocar finalizar -> pantalla de los puntos obtenidos, que se almacenaron en la tabla
                    resultadoDiv.innerHTML = '<p style="color: red;">Incorrecto. La respuesta correcta está resaltada en verde.</p>';
                }

            });
        });
        const botonContinuar = document.getElementById('boton_continuar');
        botonContinuar.addEventListener("click", function () {
            console.log("enviando")
            let idMatch = document.getElementById('idMatch');
            if (esCorrecta){
                window.location.href = `/PreguntasYRespuestasPHP/game/playAgain?id=1&idMatch=${idMatch}`;
            } else {
                window.location.href = `/PreguntasYRespuestasPHP/game/finish?id=1&idMatch=1`;
            }
        })
    });

</script>


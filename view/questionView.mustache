<div class="text-center bg-light-subtle">
    <h1 class="p-3">Pregunta</h1>

    <p class="fs-3 fw-semibold">{{enunciado}}</p>
    <p class="fw-bold">Dificultad: {{dificultad}}</p>

    <p class="fs-6 fw-medium">Selecciona la respuesta</p>
    <ul id="respuestas" class="list-group">
        {{#respuestas}}
            <li>
                <div class="d-grid gap-2 col-6 mx-auto">
                    <button class="btn btn-outline-dark p-3 m-1 respuesta-btn" data-correcta="{{es_correcta}}">
                        {{texto_respuesta}}
                    </button>
                </div>

            </li>
        {{/respuestas}}
    </ul>
    <div id="botón">
        <button name="es-correcta" id="boton_continuar" class="btn btn-dark p-3 m-1">Continuar</button>
    </div>
</div>



<div id="resultado" style="margin-top: 10px;"></div>
<input type="hidden" value="{{idMatch}}" id="idMatch">

<script>
    let esCorrecta;
    document.addEventListener('DOMContentLoaded', function () {
        const respuestaButtons = document.querySelectorAll('.respuesta-btn');
        const resultadoDiv = document.getElementById('resultado');

        respuestaButtons.forEach(button => {
            button.addEventListener('click', function () {
                esCorrecta = this.getAttribute('data-correcta') === "1"; // Ajusta "1" si es booleano en tu base de datos

                respuestaButtons.forEach(btn => {
                    const btnEsCorrecta = btn.getAttribute('data-correcta') === "1";
                    if (btnEsCorrecta) {
                        btn.classList.add('text-center', 'p-3', 'mb-1', 'bg-success', 'text-white', 'border-success');
                        //btn.style.backgroundColor = 'green';
                        //btn.style.color = 'white';
                    } else {
                        btn.classList.add('text-center', 'p-3', 'mb-1', 'bg-danger', 'text-white', 'border-danger');
                        //btn.style.backgroundColor = 'red';
                        //btn.style.color = 'white';
                    }
                });

                if (esCorrecta) {
                    resultadoDiv.innerHTML = '<p class="text-center p-3 mb-2 bg-success text-white fw-bold">¡Correcto!</p>';
                    // deberia volver a tirar rule por ende rederigir y que tire de nuevo
                    // Antes de la pregunta debemos crear el objeto intermedio entre user y partida, para poder ir almacenando
                    // los puntajes y si pierda ya tener los puntos y mostrarlos
                } else {
                    // si pierde tiene que tocar finalizar -> pantalla de los puntos obtenidos, que se almacenaron en la tabla
                    resultadoDiv.innerHTML = '<p class="text-center p-3 mb-2 bg-danger text-white fw-bold">Incorrecto. La respuesta correcta está resaltada en verde.</p>';
                }

            });
        });
        const botonContinuar = document.getElementById('boton_continuar');
        botonContinuar.addEventListener("click", function () {
            console.log("enviando")
            let idMatch = document.getElementById('idMatch');
            if (esCorrecta){
                window.location.href = `/PreguntasYRespuestasPHP/game/playAgain?id=1&idMatch=${idMatch}`;
            } else {
                window.location.href = `/PreguntasYRespuestasPHP/game/finish?id=1&idMatch=1`;
            }
        })
    });

</script>


<div class="text-center bg-light-subtle">
    <h1 class="p-3">Pregunta</h1>

    <p class="fs-3 fw-semibold">{{enunciado}}</p>
    <p class="fw-bold">Dificultad: {{dificultad}}</p>

    <p class="fs-6 fw-medium">Selecciona la respuesta</p>
    <ul id="respuestas" class="list-group">
        {{#respuestas}}
            <li>
                <div class="d-grid gap-2 col-6 mx-auto">
                    <button class="btn btn-outline-dark p-3 m-1 respuesta-btn" onclick="sendQuestion({{answer_id}})">
                        {{texto_respuesta}}
                    </button>
                </div>
            </li>
        {{/respuestas}}
    </ul>
</div>

<div id="resultado" style="margin-top: 10px;"></div>
<input type="hidden" value="{{idMatch}}" id="idMatch">
<input type="hidden" value="{{question_id}}" id="question_id">

<script>
    async function sendQuestion(answer_id) {
        let idMatch = document.getElementById('idMatch').value;
        let idQuestion = document.getElementById('question_id').value;

        // Preparar los datos a enviar en la solicitud POST
        let data = new FormData();
        data.append('idMatch', idMatch);
        data.append('idQuestion', idQuestion);
        data.append('idResponse', answer_id);

        try {
            // Realizar la solicitud AJAX al controlador `sendQuestion`
            let response = await fetch('/PreguntasYRespuestasPHP/game/sendQuestion', {
                method: 'POST',
                body: data
            });

            if (!response.ok) {
                throw new Error('Error en la solicitud');
            }

            let result = await response.json(); // Asumimos que el controlador retorna JSON

            // Mostrar el resultado de la respuesta
            if (result.correct) {
                document.getElementById('resultado').innerHTML = '<p class="text-success">Â¡Respuesta correcta!</p>';
            } else {
                document.getElementById('resultado').innerHTML = `
                    <p class="text-danger">Respuesta incorrecta. Puntaje final: ${result.score}</p>`;
            }
        } catch (error) {
            console.error('Error:', error);
            document.getElementById('resultado').innerHTML = '<p class="text-danger">Error al enviar la respuesta.</p>';
        }
    }
</script>
